Waiting for JIT...
num_batches 4096
0
Traced<ShapedArray(float32[])>with<DynamicJaxprTrace(level=3/1)>
3.3840253
Traced<ConcreteArray(3.3840253353118896, dtype=float32)>with<JVPTrace(level=2/0)> with
  primal = Array(3.3840253, dtype=float32)
  tangent = Traced<ShapedArray(float32[])>with<JaxprTrace(level=1/0)> with
    pval = (ShapedArray(float32[]), None)
    recipe = JaxprEqnRecipe(eqn_id=<object object at 0x16d72b420>, in_tracers=(Traced<ShapedArray(float32[16305]):JaxprTrace(level=1/0)>,), out_tracer_refs=[<weakref at 0x16dbc2220; to 'JaxprTracer' at 0x16d73a680>], out_avals=[ShapedArray(float32[])], primitive=pjit, params={'jaxpr': { [34m[1mlambda [39m[22m; a[35m:f32[16305][39m. [34m[1mlet
[34m[1m    [39m[22mb[35m:f32[][39m = reduce_sum[axes=(0,)] a
    c[35m:f32[][39m = div b 16305.0
  [34m[1min [39m[22m(c,) }, 'in_shardings': (UnspecifiedValue,), 'out_shardings': (UnspecifiedValue,), 'resource_env': None, 'donated_invars': (False,), 'name': '_mean', 'keep_unused': False, 'inline': True}, effects=set(), source_info=SourceInfo(traceback=<jaxlib.xla_extension.Traceback object at 0x33e046bd0>, name_stack=NameStack(stack=(Transform(name='jvp'),))))
1
I0221 13:26:05.057925 8280885312 utils.py:148] Note: NumExpr detected 12 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
I0221 13:26:05.058109 8280885312 utils.py:160] NumExpr defaulting to 8 threads.
[13:26:05 - main - INFO] --------------------------
[13:26:05 - main - INFO] Iter:   0    Time: 0.663
[13:26:05 - main - INFO] -----------  -------------
[13:26:05 - main - INFO] mse_loss     3.384e+00
jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.
The above exception was the direct cause of the following exception:
Traceback (most recent call last):
  File "/Users/akshayjacobthomas/Documents/GitHub/DiffMicromehanics/surrogate/main.py", line 40, in <module>
    app.run(main)
  File "/Users/akshayjacobthomas/anaconda3/envs/jax_trial/lib/python3.9/site-packages/absl/app.py", line 308, in run
    _run_main(main, args)
  File "/Users/akshayjacobthomas/anaconda3/envs/jax_trial/lib/python3.9/site-packages/absl/app.py", line 254, in _run_main
    sys.exit(main(argv))
  File "/Users/akshayjacobthomas/Documents/GitHub/DiffMicromehanics/surrogate/main.py", line 32, in main
    train.train_and_evaluate(FLAGS.config, FLAGS.workdir)
  File "/Users/akshayjacobthomas/Documents/GitHub/DiffMicromehanics/surrogate/train.py", line 81, in train_and_evaluate
    model.state = model.step(model.state, batch)
ValueError: pmap got inconsistent sizes for array axes to be mapped:
  * most axes (29 of them) had size 1, e.g. axis 0 of args[0].step of type int32[1];
  * one axis had size 0: axis 0 of args[1] of type float32[0,16305,15]