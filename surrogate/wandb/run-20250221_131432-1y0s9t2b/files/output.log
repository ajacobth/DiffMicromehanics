Waiting for JIT...
num_batches 4096
0
Traced<ShapedArray(float32[])>with<DynamicJaxprTrace(level=3/1)>
3.3840253
Traced<ConcreteArray(3.3840253353118896, dtype=float32)>with<JVPTrace(level=2/0)> with
  primal = Array(3.3840253, dtype=float32)
  tangent = Traced<ShapedArray(float32[])>with<JaxprTrace(level=1/0)> with
    pval = (ShapedArray(float32[]), None)
    recipe = JaxprEqnRecipe(eqn_id=<object object at 0x174ce2420>, in_tracers=(Traced<ShapedArray(float32[16305]):JaxprTrace(level=1/0)>,), out_tracer_refs=[<weakref at 0x174ca4e00; to 'JaxprTracer' at 0x174ec8270>], out_avals=[ShapedArray(float32[])], primitive=pjit, params={'jaxpr': { [34m[1mlambda [39m[22m; a[35m:f32[16305][39m. [34m[1mlet
[34m[1m    [39m[22mb[35m:f32[][39m = reduce_sum[axes=(0,)] a
    c[35m:f32[][39m = div b 16305.0
  [34m[1min [39m[22m(c,) }, 'in_shardings': (UnspecifiedValue,), 'out_shardings': (UnspecifiedValue,), 'resource_env': None, 'donated_invars': (False,), 'name': '_mean', 'keep_unused': False, 'inline': True}, effects=set(), source_info=SourceInfo(traceback=<jaxlib.xla_extension.Traceback object at 0x32fac8d80>, name_stack=NameStack(stack=(Transform(name='jvp'),))))
Traceback (most recent call last):
  File "/Users/akshayjacobthomas/anaconda3/envs/jax_trial/lib/python3.9/site-packages/ml_collections/config_dict/config_dict.py", line 903, in __getitem__
    field = self._fields[key]
KeyError: 'use_causal'
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/Users/akshayjacobthomas/anaconda3/envs/jax_trial/lib/python3.9/site-packages/ml_collections/config_dict/config_dict.py", line 827, in __getattr__
    return self[attribute]
  File "/Users/akshayjacobthomas/anaconda3/envs/jax_trial/lib/python3.9/site-packages/ml_collections/config_dict/config_dict.py", line 909, in __getitem__
    raise KeyError(self._generate_did_you_mean_message(key, str(e)))
KeyError: "'use_causal'"
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/Users/akshayjacobthomas/Documents/GitHub/DiffMicromehanics/surrogate/main.py", line 40, in <module>
    app.run(main)
  File "/Users/akshayjacobthomas/anaconda3/envs/jax_trial/lib/python3.9/site-packages/absl/app.py", line 308, in run
    _run_main(main, args)
  File "/Users/akshayjacobthomas/anaconda3/envs/jax_trial/lib/python3.9/site-packages/absl/app.py", line 254, in _run_main
    sys.exit(main(argv))
  File "/Users/akshayjacobthomas/Documents/GitHub/DiffMicromehanics/surrogate/main.py", line 32, in main
    train.train_and_evaluate(FLAGS.config, FLAGS.workdir)
  File "/Users/akshayjacobthomas/Documents/GitHub/DiffMicromehanics/surrogate/train.py", line 89, in train_and_evaluate
    log_dict = evaluator(state, batch)
  File "/Users/akshayjacobthomas/Documents/GitHub/DiffMicromehanics/surrogate/models.py", line 61, in __call__
    if self.config.weighting.use_causal:
  File "/Users/akshayjacobthomas/anaconda3/envs/jax_trial/lib/python3.9/site-packages/ml_collections/config_dict/config_dict.py", line 829, in __getattr__
    raise AttributeError(e)
AttributeError: "'use_causal'"